<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Elasticsearch之检索, railsoil">
    <meta name="description" content="4. Elasticsearch之检索4. 检索4.1 样本测试数据准备一份顾客银行账户信息的虚构的JSON  文档样本,每个文档下面都用下列的schema(模式)
&amp;amp;#123;
    &#34;account_number&#34;: 1,
 ">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Elasticsearch之检索 | railsoil</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="railsoil" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">railsoil</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">railsoil</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Elasticsearch之检索</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/elasticsearch/" class="post-category">
                                elasticsearch
                            </a>
                        
                            <a href="/categories/elasticsearch/elasticsearch/" class="post-category">
                                elasticsearch
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-01-04
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    28 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="4-Elasticsearch之检索"><a href="#4-Elasticsearch之检索" class="headerlink" title="4. Elasticsearch之检索"></a>4. Elasticsearch之检索</h1><h2 id="4-检索"><a href="#4-检索" class="headerlink" title="4. 检索"></a>4. 检索</h2><h3 id="4-1-样本测试数据"><a href="#4-1-样本测试数据" class="headerlink" title="4.1 样本测试数据"></a>4.1 样本测试数据</h3><p>准备一份顾客银行账户信息的虚构的<code>JSON</code>  文档样本,每个文档下面都用下列的<code>schema</code>(模式)</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"balance"</span><span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
    <span class="token property">"firstname"</span><span class="token operator">:</span> <span class="token string">"Amber"</span><span class="token punctuation">,</span>
    <span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token string">"Duke"</span><span class="token punctuation">,</span>
    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
    <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
    <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"880 Holmes Lane"</span><span class="token punctuation">,</span>
    <span class="token property">"employer"</span><span class="token operator">:</span> <span class="token string">"Pyrami"</span><span class="token punctuation">,</span>
    <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"amberduke@pyrami.com"</span><span class="token punctuation">,</span>
    <span class="token property">"city"</span><span class="token operator">:</span> <span class="token string">"Brogan"</span><span class="token punctuation">,</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token string">"IL"</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>从 <code>[https://github.com/elastic/elasticsearch/blob/master/docs/src/test/resources/accounts.json] </code>  导入测试数据</p>
<p><code>POST bank/account/_bulk</code></p>
<h3 id="4-2-检索"><a href="#4-2-检索" class="headerlink" title="4.2 检索"></a>4.2 检索</h3><h4 id="4-2-1-search-api"><a href="#4-2-1-search-api" class="headerlink" title="4.2.1 search api"></a>4.2.1 <code>search api</code></h4><p><code>ES</code> 支持两种基本方式检索</p>
<ul>
<li>通过<code>REST request uri</code>发送搜索参数(uri+搜索参数)</li>
<li>通过<code>REST request body</code>  来发送参数(uri+请求体)</li>
</ul>
<p>信息检索</p>
<blockquote>
<p> 一切检索从<code>_search</code>开始</p>
</blockquote>
<ul>
<li><p><code>GET /bank/_search</code>    </p>
<blockquote>
<p>检索<code>bank</code> 下所有信息,包括<code>type</code>和<code>docs</code></p>
</blockquote>
</li>
<li><p><code>GET</code> <code>bank/_search?q=*&amp;sort=account_number:asc</code> </p>
<blockquote>
<p> 请求参数方式检索</p>
</blockquote>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">887</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16623</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Bradshaw"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Mckenzie"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"244 Columbus Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Euron"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"bradshawmckenzie@euron.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Hobucken"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"CO"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">0</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Amber"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Duke"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"880 Holmes Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pyrami"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"amberduke@pyrami.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Brogan"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">1</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">28838</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Roberta"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Bender"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"560 Kingsway Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Chillium"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"robertabender@chillium.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Bennett"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"LA"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">2</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">44947</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Levine"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Burks"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"328 Wilson Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Amtap"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"levineburks@amtap.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Cochranville"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"HI"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">3</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">27658</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Rodriquez"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Flores"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"986 Wyckoff Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Tourmania"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"rodriquezflores@tourmania.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Eastvale"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"HI"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">4</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">29342</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Leola"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Stewart"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"311 Elm Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Diginetic"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"leolastewart@diginetic.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Fairview"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"NJ"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">5</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"6"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">5686</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Hattie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Bond"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"671 Bristol Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Netagy"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"hattiebond@netagy.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Dante"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"TN"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">6</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"7"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">39121</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Levy"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Richard"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"820 Logan Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Teraprene"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"levyrichard@teraprene.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Shrewsbury"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"MO"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">7</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"8"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">48868</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Jan"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Burns"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"699 Visitation Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Glasstep"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"janburns@glasstep.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Wakulla"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AZ"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">8</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"9"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">24776</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Opal"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Meadows"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"963 Neptune Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Cedward"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"opalmeadows@cedward.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Olney"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"OH"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">9</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>响应结果解释: </p>
<ul>
<li><code>took</code>: <code>es</code> 执行搜索的时间(毫秒)</li>
<li><code>time_out</code>: 告诉我们搜索是否超时</li>
<li><code>_shards</code>: 告诉我们多少个分片被搜索了,以及统计了成功/失败的搜索分片</li>
<li><code>hits</code>: 搜索结果</li>
<li><code>hits.total</code>: 搜索结果总条数</li>
<li><code>hits.hits</code>: 实际的搜索结果(数组), 默认为前10 的文档 </li>
<li><code>sort</code>: 结果的排序key(键), 没有则按照 <code>scort</code> 排序</li>
<li><code>score</code> 和<code>max_score</code> : 相关性得分和最高得分(全文检索用)</li>
</ul>
<p>详细的字段信息，参照： <a target="_blank" rel="noopener" href="https://_www.elastic.co_guide_en_elasticsearch_reference_current_getting-started-search/">https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html</a></p>
</li>
</ul>
<h3 id="4-3-Query-DSL"><a href="#4-3-Query-DSL" class="headerlink" title="4.3 Query DSL"></a>4.3 <code>Query DSL</code></h3><h4 id="4-3-1-基本语法格式"><a href="#4-3-1-基本语法格式" class="headerlink" title="4.3.1 基本语法格式"></a>4.3.1 基本语法格式</h4><p><code>Elasticsearch</code>  提供了一个可以执行查询的<code>json</code> 风格的<code>DSL</code>, 这个被称为<code>Query DSL</code>, 该查询语句非常全面,一个查询语句的典型结构: </p>
<pre class=" language-json"><code class="language-json">QUERY_NAME<span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
   ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>
   ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>...
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>如果针对某个字段,那么它的结构如下: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  QUERY_NAME<span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
     FIELD_NAME<span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
       ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>
       ARGUMENT<span class="token operator">:</span>VALUE<span class="token punctuation">,</span>...
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>   
   &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"from"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"order"</span><span class="token operator">:</span> <span class="token string">"desc"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  <span class="token punctuation">]</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p><code>query</code> 定义了如何查询</p>
<ul>
<li><code>match_all</code> : 查询类型(代表查询所有的数据), <code>es</code>中可以在<code>query</code> 中组合非常多的查询类型来完成复杂查询</li>
<li>除 了<code>query</code> 参数之后,我们也可以传递其他的参数以改变查询的结果,比如<code>sort</code>,<code>size</code></li>
<li><code>form</code>+<code>szie</code> 限定, 完成分页功能</li>
<li><code>sort</code>排序,多字段排序,会在前序字段相等时后续字段内部排序,否则以前序为准</li>
</ul>
<h4 id="4-3-2-返回部分字段"><a href="#4-3-2-返回部分字段" class="headerlink" title="4.3.2  返回部分字段"></a>4.3.2  返回部分字段</h4><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"from"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"order"</span><span class="token operator">:</span> <span class="token string">"desc"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"_source"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">,</span><span class="token string">"firstname"</span><span class="token punctuation">]</span>
  
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">221</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"999"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Dorothy"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">6087</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">999</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"998"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Letha"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16869</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">998</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"997"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Combs"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">25311</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">997</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"996"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Andrews"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">17541</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">996</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"995"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Phelps"</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">21153</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"sort"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">995</span>
        <span class="token punctuation">]</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-3-3-match-匹配查询"><a href="#4-3-3-match-匹配查询" class="headerlink" title="4.3.3 match 匹配查询"></a>4.3.3 <code>match</code> 匹配查询</h4><ul>
<li>基本类型(非字符串), 精切控制</li>
</ul>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"account_number"</span><span class="token operator">:</span> <span class="token string">"20"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p><code>match</code> 返回 account_number=20的数据</p>
<p>返回结果; </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">774</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16418</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Elinor"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Ratliff"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"282 Kings Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Scentric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"elinorratliff@scentric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Ribera"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WA"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li><p>字符串: 全文检索</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"kings"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>全文检索,最后会按照评分进行排序,会对检索条件进行分词匹配</p>
<p>查询结果:</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">790</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.095661</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.095661</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">16418</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Elinor"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Ratliff"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"282 Kings Place"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Scentric"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"elinorratliff@scentric.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Ribera"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"WA"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"722"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.095661</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">722</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">27256</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Roberts"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Beasley"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"305 Kings Hwy"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Quintity"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"robertsbeasley@quintity.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Hayden"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"PA"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
<h4 id="4-3-4-match-phrase-短句匹配"><a href="#4-3-4-match-phrase-短句匹配" class="headerlink" title="4.3.4 match_phrase 短句匹配"></a>4.3.4 <code>match_phrase</code> 短句匹配</h4><p>将需要匹配的值当成一整个单词(不分词) 进行检索</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_phrase"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill road"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>查看 <code>address</code> 中包含 <code>mill road</code>的所有记录, 并且给出相关性得分.</p>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">6278</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">8.991257</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">8.991257</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p><code>match</code>  和<code>match_phrase</code> 的区别,观察如下例子: </p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_phrase"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"990 Mill"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果:</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">48</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">10.919691</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">10.919691</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>使用<code>match</code> 的<code>keyword</code></p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address.keyword"</span><span class="token operator">:</span> <span class="token string">"990 Mill"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>查看结果, 一条也没有匹配到</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>修改匹配条件为: <code>990 Mill Road</code></p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address.keyword"</span><span class="token operator">:</span> <span class="token string">"990 Mill Road"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>查询出来一条数据</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">133</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.685111</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.685111</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>文本字段的匹配,使用<code>keyword</code>, 匹配的条件就是要显示字段的全部值,要进行精确匹配,<code>match_phrase</code> 是做短语匹配的,只要是文本中包含匹配条件,就能匹配到. </p>
<h4 id="4-3-5-multi-math-多字段匹配"><a href="#4-3-5-multi-math-多字段匹配" class="headerlink" title="4.3.5 multi_math 多字段匹配"></a>4.3.5 <code>multi_math</code> 多字段匹配</h4><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"multi_match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"mill"</span><span class="token punctuation">,</span>
      <span class="token property">"fields"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"state"</span><span class="token punctuation">,</span>
        <span class="token string">"address"</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p><code>state</code> 或者<code>address</code> 中包含<code>mill</code>, 并且在查询的过程中 , 会对于查询条件进行分词. </p>
<p>查询结果:</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">121</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"472"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">472</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">25571</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Lee"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Long"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"288 Mill Street"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Comverges"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"leelong@comverges.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Movico"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"MT"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-3-6-bool-用来做复合查询"><a href="#4-3-6-bool-用来做复合查询" class="headerlink" title="4.3.6  bool  用来做复合查询"></a>4.3.6  <code>bool</code>  用来做复合查询</h4><p>复合语句可以合并,任何其他查询语句,包括复合语句,这也就是意味着复合语句之间可以互相嵌套,可以表达非常复杂的逻辑. </p>
<h5 id="must-必须达到must-所列举的所有条件"><a href="#must-必须达到must-所列举的所有条件" class="headerlink" title="must:  必须达到must 所列举的所有条件"></a><code>must</code>:  必须达到<code>must</code> 所列举的所有条件</h5><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p> 查看<code>address=mill</code> 和<code>gender=M</code>的数据</p>
<p>返回结果:</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="must-not-必须不匹配must-not-所列举的所有条件"><a href="#must-not-必须不匹配must-not-所列举的所有条件" class="headerlink" title="must not 必须不匹配must not 所列举的所有条件"></a><code>must not</code> 必须不匹配<code>must not</code> 所列举的所有条件</h5><p>查询<code>gender=M</code> 并且<code>address =mill</code>的,但是<code>age!=38</code>的数据</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"age"</span><span class="token operator">:</span> <span class="token string">"30"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="should-应该达到should-列举的条件-如果达到就会增加相关文档的评分-并不会改变查询的结果-如果query-中只有should-且只有一种匹配规则-那么should-的条件就会被作为默认匹配条件去改变查询结果"><a href="#should-应该达到should-列举的条件-如果达到就会增加相关文档的评分-并不会改变查询的结果-如果query-中只有should-且只有一种匹配规则-那么should-的条件就会被作为默认匹配条件去改变查询结果" class="headerlink" title="should  应该达到should   列举的条件,如果达到就会增加相关文档的评分, 并不会改变查询的结果, 如果query 中只有should   且只有一种匹配规则,那么should  的条件就会被作为默认匹配条件去改变查询结果"></a><code>should</code>  应该达到<code>should</code>   列举的条件,如果达到就会增加相关文档的评分, 并不会改变查询的结果, 如果<code>query</code> 中只有<code>should</code>   且只有一种匹配规则,那么<code>should</code>  的条件就会被作为默认匹配条件去改变查询结果</h5><p>例子: 匹配<code>lastName</code> 应该等于<code>Wallace</code>的数据</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"gender"</span><span class="token operator">:</span> <span class="token string">"M"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"must_not"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"age"</span><span class="token operator">:</span> <span class="token string">"30"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"should"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"lastname"</span><span class="token operator">:</span> <span class="token string">"Wallace"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">18145</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">12.824207</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">12.824207</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"136"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">136</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">45801</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Winnie"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Holland"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"198 Mill Lane"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Neteria"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"winnieholland@neteria.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Urie"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"IL"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"345"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">6.1390967</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">345</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">9812</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Parker"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Hines"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"715 Mill Avenue"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Baluba"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"parkerhines@baluba.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Blackgum"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"KY"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>能够看到相关度越高,得分也就越高</p>
<h4 id="4-3-7-Filter-结果过滤"><a href="#4-3-7-Filter-结果过滤" class="headerlink" title="4.3.7 Filter  结果过滤"></a>4.3.7 <code>Filter</code>  结果过滤</h4><p>并不是所有的查询都需要产生分数,特别是哪些仅用于<code>filter</code> 过滤的文档 . 为了不计算分数,<code>es</code> 会自动检查场景并且优化查询的执行</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"bool"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"must"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"range"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"balance"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
              <span class="token property">"gte"</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
              <span class="token property">"lte"</span><span class="token operator">:</span> <span class="token number">20000</span>
            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>这里先查询所有匹配<code>address=mill</code>的文档,然后再根据<code>10000&lt;=balance&lt;=20000</code>进行结果查询, 查询结果:</p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">66</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"_index"</span> <span class="token operator">:</span> <span class="token string">"bank"</span><span class="token punctuation">,</span>
        <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"account"</span><span class="token punctuation">,</span>
        <span class="token property">"_id"</span> <span class="token operator">:</span> <span class="token string">"970"</span><span class="token punctuation">,</span>
        <span class="token property">"_score"</span> <span class="token operator">:</span> <span class="token number">5.4598455</span><span class="token punctuation">,</span>
        <span class="token property">"_source"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"account_number"</span> <span class="token operator">:</span> <span class="token number">970</span><span class="token punctuation">,</span>
          <span class="token property">"balance"</span> <span class="token operator">:</span> <span class="token number">19648</span><span class="token punctuation">,</span>
          <span class="token property">"firstname"</span> <span class="token operator">:</span> <span class="token string">"Forbes"</span><span class="token punctuation">,</span>
          <span class="token property">"lastname"</span> <span class="token operator">:</span> <span class="token string">"Wallace"</span><span class="token punctuation">,</span>
          <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span>
          <span class="token property">"address"</span> <span class="token operator">:</span> <span class="token string">"990 Mill Road"</span><span class="token punctuation">,</span>
          <span class="token property">"employer"</span> <span class="token operator">:</span> <span class="token string">"Pheast"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span> <span class="token operator">:</span> <span class="token string">"forbeswallace@pheast.com"</span><span class="token punctuation">,</span>
          <span class="token property">"city"</span> <span class="token operator">:</span> <span class="token string">"Lopezo"</span><span class="token punctuation">,</span>
          <span class="token property">"state"</span> <span class="token operator">:</span> <span class="token string">"AK"</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>Each <code>must</code>, <code>should</code>, and <code>must_not</code> element in a Boolean query is referred to as a query clause. How well a document meets the criteria in each <code>must</code> or <code>should</code> clause contributes to the document’s <em>relevance score</em>. The higher the score, the better the document matches your search criteria. By default, Elasticsearch returns documents ranked by these relevance scores.<br>在boolean查询中，<code>must</code>, <code>should</code> 和<code>must_not</code> 元素都被称为查询子句 。 文档是否符合每个“must”或“should”子句中的标准，决定了文档的“相关性得分”。  得分越高，文档越符合您的搜索条件。  默认情况下，Elasticsearch返回根据这些相关性得分排序的文档。<br>The criteria in a <code>must_not</code> clause is treated as a <em>filter</em>. It affects whether or not the document is included in the results, but does not contribute to how documents are scored. You can also explicitly specify arbitrary filters to include or exclude documents based on structured data.</p>
<p><code>“must_not”子句中的条件被视为“过滤器”。</code> 它影响文档是否包含在结果中，  但不影响文档的评分方式。  还可以显式地指定任意过滤器来包含或排除基于结构化数据的文档。</p>
<p><code>filter</code> 在使用过程中,并不会计算相关性得分</p>
<h4 id="4-3-8-term"><a href="#4-3-8-term" class="headerlink" title="4.3.8 term"></a>4.3.8 <code>term</code></h4><p>和<code>match</code> 一样,匹配某个属性的值,全文检索字段用<code>match</code>, 其他非<code>text</code>字段匹配用<code>term</code></p>
<blockquote>
<p>Avoid using the <code>term</code> query for <a target="_blank" rel="noopener" href="https://_www.elastic.co_guide_en_elasticsearch_reference_7.6_text/"><code>text</code></a> fields.<br>避免对文本字段使用“term”查询<br>By default, Elasticsearch changes the values of <code>text</code> fields as part of <a href="">analysis</a>. This can make finding exact matches for <code>text</code> field values difficult.<br>默认情况下，Elasticsearch作为<a href="">analysis</a>的一部分更改’ text ‘字段的值。这使得为“text”字段值寻找精确匹配变得困难。<br>To search <code>text</code> field values, use the match.<br>要搜索“text”字段值，请使用匹配。<br>[<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html]">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html]</a>(</p>
</blockquote>
<p>使用<code>term</code> 匹配查询</p>
<pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"term"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"mill Road"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>一条也没有匹配到, 更换为<code>match</code>后, 就可以匹配到32个</p>
<p>也就是说, 全文检索字段用<code>match</code>, 其他非<code>text</code> 字段匹配用<code>match</code></p>
<h4 id="4-3-9-Aggregation-执行聚合"><a href="#4-3-9-Aggregation-执行聚合" class="headerlink" title="4.3.9 Aggregation 执行聚合"></a>4.3.9 <code>Aggregation</code> 执行聚合</h4><p>聚合提供了从数据中分组和提取数据的能力,最简单的聚合方法大致等于<code>SQL Group by</code>和<code>SQL</code>的聚合函数, 在<code>es</code>中,执行搜索返回<code>hits</code>( 命中结果), 并且同时返回聚合结果,把响应中所有的<code>hits</code>(命中结果)分隔开的能力, 这是非常强大并且有效的, 你可以执行查询和多个聚合,并且在一次使用中得到各自的(任何一个)返回结果,使用一次简介和简化的API 就可以避免网络往返. </p>
<p><code>size:0</code> 不显示搜索数据</p>
<p><code>aggs</code> 执行聚合,聚合语法如下: </p>
<pre class=" language-json"><code class="language-json"><span class="token property">"aggs"</span><span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"aggs_name这次聚合的名字，方便展示在结果集中"</span><span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"AGG_TYPE聚合的类型(avg,term,terms)"</span><span class="token operator">:</span>&amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
     &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>，
</code></pre>
<h5 id="例子-搜索address-中包含mill-的所有人的年龄分布以及平均年龄-但是不显示这些人的详情"><a href="#例子-搜索address-中包含mill-的所有人的年龄分布以及平均年龄-但是不显示这些人的详情" class="headerlink" title="例子: 搜索address 中包含mill 的所有人的年龄分布以及平均年龄,但是不显示这些人的详情"></a>例子: 搜索<code>address</code> 中包含<code>mill</code> 的所有人的年龄分布以及平均年龄,但是不显示这些人的详情</h5><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"mill"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">10</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"ageAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"avg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>

</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">1229</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"aggregations"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"ageAgg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">2</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">1</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">1</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">34.0</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"balanceAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25208.0</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>复杂的查询： </p>
<h5 id="按照年龄聚合-并且求这些年龄段的人的平均薪资"><a href="#按照年龄聚合-并且求这些年龄段的人的平均薪资" class="headerlink" title="按照年龄聚合,并且求这些年龄段的人的平均薪资"></a>按照年龄聚合,并且求这些年龄段的人的平均薪资</h5><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">100</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"ageAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"avg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果: </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"took"</span> <span class="token operator">:</span> <span class="token number">3307</span><span class="token punctuation">,</span>
  <span class="token property">"timed_out"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"_shards"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"successful"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"skipped"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"failed"</span> <span class="token operator">:</span> <span class="token number">0</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"hits"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"total"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">"relation"</span> <span class="token operator">:</span> <span class="token string">"eq"</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"max_score"</span> <span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"aggregations"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"ageAgg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"doc_count_error_upper_bound"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"sum_other_doc_count"</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">"buckets"</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28312.918032786885</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25269.583333333332</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">23194.813559322032</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">23951.346153846152</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22136.69230769231</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22174.71153846154</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">24731.07843137255</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28273.882352941175</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">33</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">25093.94</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26809.95918367347</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">22841.106382978724</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">46</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26981.434782608696</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27183.17777777778</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">44</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27741.227272727272</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27314.214285714286</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">28519.04761904762</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27445.214285714286</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">27022.261904761905</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">21471.871794871793</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">26187.17948717949</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"key"</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token property">"doc_count"</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token property">"ageAvg"</span> <span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"value"</span> <span class="token operator">:</span> <span class="token number">29483.14285714286</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      <span class="token punctuation">]</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="查询所有年龄分布-并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资"><a href="#查询所有年龄分布-并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资" class="headerlink" title="查询所有年龄分布,并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资"></a>查询所有年龄分布,并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资</h5><pre class=" language-json"><code class="language-json">GET bank/_search
&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token property">"query"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"match_all"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"ageAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
      <span class="token property">"terms"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span>
        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">100</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
      <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"genderAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"terms"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"gender.keyword"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
          <span class="token property">"aggs"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
              <span class="token property">"avg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
              &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
        <span class="token property">"ageBalanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
          <span class="token property">"avg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"balance"</span>
          &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
      &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
  &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
  <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">0</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>
<p>返回结果： </p>
<pre class=" language-json"><code class="language-json">&amp;#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token property">"_shards"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"failed"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"skipped"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"successful"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">1</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"aggregations"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"ageAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"buckets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                    <span class="token property">"ageBalanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">28312.918032786885</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
                    <span class="token property">"genderAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"buckets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">29565.628571428573</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"M"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">26626.576923076922</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"F"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token property">"doc_count_error_upper_bound"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token property">"sum_other_doc_count"</span><span class="token operator">:</span> <span class="token number">0</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"key"</span><span class="token operator">:</span> <span class="token number">31</span>
                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                    <span class="token property">"ageBalanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">25269.583333333332</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
                    <span class="token property">"genderAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"buckets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">26348.684210526317</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"F"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">23405.68181818182</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"M"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token property">"doc_count_error_upper_bound"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token property">"sum_other_doc_count"</span><span class="token operator">:</span> <span class="token number">0</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"key"</span><span class="token operator">:</span> <span class="token number">39</span>
                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                    <span class="token property">"ageBalanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">23194.813559322032</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
                    <span class="token property">"genderAgg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                        <span class="token property">"buckets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">25094.78125</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"M"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                            &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                <span class="token property">"balanceAvg"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
                                    <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">20943.0</span>
                                &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                                <span class="token property">"doc_count"</span><span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
                                <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"F"</span>
                            &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
                        <span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token property">"doc_count_error_upper_bound"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token property">"sum_other_doc_count"</span><span class="token operator">:</span> <span class="token number">0</span>
                    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
                    <span class="token property">"key"</span><span class="token operator">:</span> <span class="token number">26</span>
                &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">"doc_count_error_upper_bound"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"sum_other_doc_count"</span><span class="token operator">:</span> <span class="token number">0</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"hits"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token property">"hits"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">"total"</span><span class="token operator">:</span> &amp;#<span class="token number">123</span><span class="token punctuation">;</span>
            <span class="token property">"relation"</span><span class="token operator">:</span> <span class="token string">"eq"</span><span class="token punctuation">,</span>
            <span class="token property">"value"</span><span class="token operator">:</span> <span class="token number">1000</span>
        &amp;#<span class="token number">125</span><span class="token punctuation">;</span>
    &amp;#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span>
    <span class="token property">"timed_out"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"took"</span><span class="token operator">:</span> <span class="token number">34</span>
&amp;#<span class="token number">125</span><span class="token punctuation">;</span>
</code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">luyanan</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://rainsoil.github.io/2022/01/04/elasticsearch/elasticsearch-zhi-jian-suo/">https://rainsoil.github.io/2022/01/04/elasticsearch/elasticsearch-zhi-jian-suo/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">luyanan</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/01/04/elasticsearch/elasticsearch-zhi-mapping/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="Elasticsearch之Mapping">
                        
                        <span class="card-title">Elasticsearch之Mapping</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-01-04
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/elasticsearch/" class="post-category">
                                    elasticsearch
                                </a>
                            
                            <a href="/categories/elasticsearch/elasticsearch/" class="post-category">
                                    elasticsearch
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/04/spring-boot/shen-ru-qian-chu-springboot-he-xin-yuan-li/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="深入浅出SpringBoot核心原理">
                        
                        <span class="card-title">深入浅出SpringBoot核心原理</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Spring-Boot/" class="post-category">
                                    Spring Boot
                                </a>
                            
                            <a href="/categories/Spring-Boot/Spring-Boot/" class="post-category">
                                    Spring Boot
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">luyanan</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">803.3k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/rainsoil" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:luyanan0718@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=914596513" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 914596513" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
